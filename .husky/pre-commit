# Move to the project root
cd "$(dirname "$0")/.." || exit 1

# Run lint-staged sequentially to prevent conflicts
echo "Running lint-staged checks..."
npx lint-staged --concurrent false || {
    echo "Lint-staged checks failed. Please fix the issues, and try again."
    exit 1
}

# Build the project
echo "The code looks fine. Starting the build process..."
npm run build || {
    echo "The Next.js build failed. Please review the errors above."
    exit 1
}

# Commit the changes
echo "The Next.js build succeeded. Proceeding to commit..."
